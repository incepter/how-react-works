---
sidebar_position: 9
---

# How Fibers creation works ⏸️

:::note
This section is a `⏸️ break`, we won't continue from where we stopped
in the previous section, but we will take the discussion to another subject
as important before going back.
:::

In this section, we will discover how, where and when all fiber's creation
occur inside React.

We've seen so many, so this is like an extension, but we will restart from the
beginning.

## How creating the first fibers works

The first created fiber refers to the `fiberRoot.current` property.

Let's restart from the begging and go by a simple example:

```tsx
import * as React from "react";
import { createRoot } from "react-dom/client";

// 1
// highlight-next-line
const root = createRoot(document.getElementById("root"));

// 2
// highlight-next-line
root.render(<App />);

function App() {
  const rerender = useRerender();
  return (
    <div>
      <h2>Hello, world!</h2>
      <h3>Hello again</h3>
      <button onClick={rerender}>rerender</button>
    </div>
  );
}

// ignore this, used to rerender our component
function useRerender() {
  return React.useState(0)[1].bind(null, (prev) => prev + 1);
}
```

During step 1, right after calling `createRoot(container)`, here is the tree
at that time:

![Result right after createRoot()](imgs/9.fiber.creation.tree.step1.png)

Next, during step 2 which will schedule things are perform lots of work, React
will construct the alternate tree, because we didn't show (commit) anything yet:

![After root.render() and before commit](imgs/9.fiber.creation.tree.step2.png)

This creation was performed inside `reconcileChildren` seen in how reconciliation
works.

After commit, the `root.current.alternate` will take over and be the new current:

![After rendering and committing](imgs/9.fiber.creation.tree.step3.png)

This process of swapping the alternate tree with the current tree is what will
happen all the time at runtime.

On updates, here is what our tree will look like:

![Tree on updates](imgs/9.fiber.creation.tree.step4.png)

To visualize this for yourself, go to any of your React applications (or if you
want, here is the link to the sandbox with our [used example](https://codesandbox.io/s/intelligent-colden-kr4tn3?file=/src/App.js))
execute the following in the console of your browser:

```tsx
// assuming there is one root
[...window.__REACT_DEVTOOLS_GLOBAL_HOOK__.getFiberRoots(1)][0];
```

This will give you the first `root`, access `root.current` and start looking
at `child` and `sibling` and `alternate` properties.

## How the `alternate` works

### What is the alternate
### How the alternate is created
